package com.Weather.Servlets;

import java.io.IOException;
import java.rmi.ServerException;

import javax.servlet.ServletException;
import javax.servlet.annotation.WebServlet;
import javax.servlet.http.HttpServlet;
import javax.servlet.http.HttpServletRequest;
import javax.servlet.http.HttpServletResponse;

import com.Weather.Entities.*;
import com.Weather.Services.*;

@WebServlet("/weather")
public class WeatherServlet extends HttpServlet {
	private static final long serialversionUID = 1L;
	
	public WeatherServlet() {
		super();
	}
	
	protected void doGet(HttpServletRequest request, HttpServletResponse response) throws ServerException, IOException {
		String input = request.getParameter("q");
		Root weatherInfoObj = OWMService.getWeatherInfo(input);
		if (weatherInfo != null) {
			System.out.println("works");
		} else {
			System.out.println("did not work");
		}
		if (weatherInfoObj != null) {
			StringBuider outContent = new StringBuilder();
			outContent.append("<html><head><title>Weather Data</title></head>"
					+ "<body>"
					+ "<form action=\"weather\" method=\"GET\">"
					+ "<select name=\"q\">"
					+ "<option value=\"Caracas\">Caracas</option>"
					+ "</select>"
					+ "<input type=\"submit\" value=\"Submit\">"
					+ "</form>");
			outContent.append(weatherInfo.getCity());
			outContent.append("<br/>");
			outContent.append("</body></html>");
		} else {
			System.out.println("broekn");
		}
	}
	
	protected void doPost(HttpServletRequest request, HttpServletResponse response) throws ServerException, IOException {
		doGet(request, response);
	}
}
